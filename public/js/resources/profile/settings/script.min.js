$(document).on('submit', '#twoFactorForm', function(e) {
    $('.field-error').html('');
    e.preventDefault();
    openLoader();
    var data = new FormData($('#twoFactorForm')[0]);
    $.ajax({
        type: 'POST',
        url: $('#twoFactorForm').attr('action'),
        data: data,
        contentType: false,
        cache: false,
        processData: false,
        success: function(response) {
            closeLoader();
            if(response.status){
                toastr.success(response.message, 'Success');
                $('#twoFactorForm').remove();
                $('.disable-two-factor-outer').removeClass('hidden');
                $('.disable-two-factor-outer button').addClass('disable-two-factor');
                $('#disable-btn').addClass('disable2FABtn');
            }
            else{
                toastr.error(response.message, 'Failed');
            }
        },
        error: function(error) {
            closeLoader();
            if (error.responseJSON.errors) {
              $('#error_one_time_password').html(error.responseJSON.errors.otp[0]);
            }
        }
    });
});

$(document).on('click', '.disable2FABtn', function(e) {
    openLoader();
    $('#disable2FA').modal('hide');
    $('.disable-two-factor-outer a').addClass('disabled');
    $.ajax({
        type: 'POST',
        url: '/disable-authentication',
        data: {confirm:true},
        success: function(response) {
            closeLoader();
            $('.disable-two-factor').addClass('disabled');
            (response.status) ? 
            toastr.success(response.message, 'Success')
            : toastr.error(response.message, 'Failed');
            setInterval(function() {location.reload()},500);
        },
        error: function(error) {
            closeLoader();
            toastr.error("Something went wrong", 'Error');
        }
    });
});